<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CreateJS test</title>
    <script src="zepto.min.js"></script>
<!--    <script src="jquery-1.11.0.min.js"></script>-->
    <script src="easeljs-0.7.1.min.js"></script>
    <script src="tweenjs-0.5.1.min.js"></script>
    <script>
      var app = {
        initialize: function () {
          var stage = this.createStage("sampleCanvas");
          var first = true;
          createjs.Ticker.addEventListener("tick", function (e) {
            if (first == true) {
              // TODO tick後じゃないとimageのサイズがとれない
              // TODO 背景画像の位置が固定になっている
              stage.canvas.width = stage.children[0].image.width;
              stage.canvas.height = stage.children[0].image.height;
              first = false;
            }
            stage.update();
            // TODO abbyの位置が固定になっている
            stage.children[1].x += 1
          });
        },
        createStage: function (id) {
          var stage = new createjs.Stage(id);
          stage.enableMouseOver(30);
          stage.addChild(this.createAbby());
          var background = new createjs.Bitmap("image/background.jpg");
          stage.addChildAt(background, 0);
          return stage;
        },
        createAbby: function () {
          var abby = new createjs.Bitmap("image/abby02.png");
          abby.addEventListener("mousedown", this.changeAbby);
          abby.addEventListener("click", this.returnAbby);
          abby.addEventListener("mouseout", this.returnAbby);
          return abby;
        },
        changeAbby: function (event) {
          event.target.image.src = "image/abby03.png";
        },
        returnAbby: function (event) {
          event.target.image.src = "image/abby02.png";
        }
      }
    </script>
  </head>
  <body onload="app.initialize();">
    <canvas id="sampleCanvas"></canvas>
  </body>
</html>
